<html>

<head>
    <title>ggg</title>
    <style>
        body {
            background-color: grey;
        }
        
        #canvas {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translateX(-50%) translateY(-50%);
        }
    </style>
</head>

<body>
    <div id="easing-wrapper"></div>

    <script src="pixi.js"></script>
    <script src="pixi-picture.umd.js"></script>
    <script src="draw.js"></script>
    <script src="colors.js"></script>
    <script src="curves.js"></script>
    <script src="perlin.js"></script>
    <script src="numbers.js"></script>
    <script src="bezier-easing.js"></script>
    <script src="index.js"></script>
    <script src="chroma.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pixi-filters@latest/dist/pixi-filters.js"></script>


    <script>

        var addText = function(text, x, y) {
            var text = new PIXI.Text(text, {
                fontFamily: 'Arial',
                fontSize: 12,
            });
            text.x = x;
            text.y = y;
            debuggingContainer.addChild(text);
        }


        let app = new PIXI.Application({
            width: 800,
            height: 800,
            antialias: true,
            autoDensity: true,
            resolution: window.devicePixelRatio || 1,
            roundPixels: true,
            powerPreference: 'high-performance'
        });
        document.body.appendChild(app.view);

        highlightColor = generateColors()

        var debuggingContainer = new PIXI.Container();

        /* Line1 */
        var pencilStyles = new pencil({
            startWidth: 1, 
            endWidth: 1, 
            iterations: 10,
            nib: 'square',
            nibSize: 0.5, 
            color: '#505050', 
            alpha: 0.6,
            density: 1200,
            widthArray: ''
        })
        var lineOptions = new line({
            x:50,
            y:50, 
            cp1:0, 
            cp2:0, 
            endX:300, 
            endY:0, 
            cp3:0, 
            cp4:0
        })
        drawLine(lineOptions, pencilStyles, debuggingContainer)
        addText('2B Pencil', 50, 75)


        /* Line2 */
        var pencilStyles = new pencil({
            startWidth: 1, 
            endWidth: 1, 
            iterations: 20,
            nib: 'square',
            nibSize: 0.5, 
            color: '#000000', 
            alpha: 0.5,
            density: 1000,
            widthArray: ''
        })
        var lineOptions = new line({
            x:50,
            y:150, 
            cp1:0, 
            cp2:0, 
            endX:300, 
            endY:0, 
            cp3:0, 
            cp4:0
        })
        drawLine(lineOptions, pencilStyles, debuggingContainer)
        addText('6B Pencil', 50, 175)

         /* Line2 */
         var pencilStyles = new pencil({
            startWidth: 0.1, 
            endWidth: 0.1, 
            iterations: 50,
            jitter: true,
            nib: 'circle',
            nibSize: 0.5, 
            color: '#000000', 
            alpha: 1,
            density: 7000,
            widthArray: ''
        })
        var lineOptions = new line({
            x:50,
            y:250, 
            cp1:0, 
            cp2:0, 
            endX:300, 
            endY:0, 
            cp3:0, 
            cp4:0
        })
        drawLine(lineOptions, pencilStyles, debuggingContainer)
        addText('0.5mm Pen', 50, 275)

        app.stage.addChild(debuggingContainer);


        /* Line2 */
        var pencilStyles = new pencil({
            startWidth: 0.75, 
            endWidth: 0.75, 
            iterations: 75,
            jitter: true,
            nib: 'circle',
            nibSize: 0.5, 
            color: '#000000', 
            alpha: 0.1,
            density: 700,
            widthArray: ''
        })
        var lineOptions = new line({
            x:50,
            y:350, 
            cp1:0, 
            cp2:0, 
            endX:300, 
            endY:0, 
            cp3:0, 
            cp4:0
        })
        drawLine(lineOptions, pencilStyles, debuggingContainer)
        addText('0.7mm Pen', 50, 375)

        app.stage.addChild(debuggingContainer);

        /* Line2 */
        var pencilStyles = new pencil({
            startWidth: 1, 
            endWidth: 1, 
            iterations: 100,
            jitter: false,
            nib: 'circle',
            nibSize: 0.7, 
            color: '#000000', 
            alpha: 0.4,
            density: 700,
            widthArray: ''
        })
        var lineOptions = new line({
            x:50,
            y:450, 
            cp1:0, 
            cp2:0, 
            endX:300, 
            endY:0, 
            cp3:0, 
            cp4:0
        })
        drawLine(lineOptions, pencilStyles, debuggingContainer)
        addText('1.0mm Pen', 50, 475)

        app.stage.addChild(debuggingContainer);


        /* Line2 */
        var pencilStyles = new pencil({
            startWidth: 2, 
            endWidth: 2, 
            iterations: 100,
            jitter: false,
            nib: 'circle',
            nibSize: 1, 
            color: '#000000', 
            alpha: 0.8,
            density: 1000,
            widthArray: 'marker'
        })
        var lineOptions = new line({
            x:50,
            y:550, 
            cp1:0, 
            cp2:0, 
            endX:300, 
            endY:0, 
            cp3:0, 
            cp4:0
        })
        drawLine(lineOptions, pencilStyles, debuggingContainer)
        addText('Felt Marker', 50, 575)

        app.stage.addChild(debuggingContainer);





        ///////// FILL STYLE & TEXTURE ////////////
        let fillContainer = new PIXI.Container()
        textureBackground = new PIXI.Graphics()
        hairColorPIXI = highlightColor
        textureBackground.beginFill(hairColorPIXI, 1);
        textureBackground.drawRect(450, 50, 200, 200);
        textureBackground.endFill();
        debuggingContainer.addChild(textureBackground)

        //use chroma.js to lighten 
        var lighten = chroma.scale([hairColorPIXI, '#ffffff']).mode('lch').colors(10)
        //get the first color in lighten and convert to hex
        var lightenHex = chroma(lighten[7]).hex()
        //remove some saturation from the color
        var lightenHex = chroma(lightenHex).saturate(-0.5).hex()
        //convert the color for use with PIXI
        var lightenPixi = PIXI.utils.string2hex(lightenHex)
        textureForeground = new PIXI.Graphics()
        for(var i = 0; i < 100000; i++){
            randomAlpha = randFloat(0, 0.065)
            //get a random number between 0 and 0.065
            textureForeground.beginFill(lightenPixi, randomAlpha)
            textureForeground.drawCircle(rand(450, 650), rand(50, 250), rand(0.5, 1.1))
            textureForeground.endFill()
            //textureForeground.blendMode = PIXI.BLEND_MODES.ADD
        }
        grain = new PIXI.filters.OldFilmFilter({
            sepia: 0.0,
            noise: 0.06,
            noiseSize: 2,
            scratch: 0.0,
            scratchDensity: 0.0,
            scratchWidth: 0.0,
            vignetting: 0.0,
            vignettingAlpha: 0.0,
            vignettingBlur: 0.0,
            seed: 0.1,
        })
        //textureForeground.filters = [grain]
        blur = new PIXI.filters.KawaseBlurFilter(0.01)
        textureForeground.filters = [blur]
        sharpnessMatrix = new PIXI.filters.ConvolutionFilter(
            [0, -1, 0,
             -1, 5, -1,
             0, -1, 0],
            400, 400
        )
        textureForeground.alpha = 0.005
        //var contrast = new PIXI.filters.AdjustmentFilter({ contrast: 1 });

        textureForeground.filters = [blur, sharpnessMatrix, grain]
        textureForeground.blendMode = PIXI.BLEND_MODES.OVERLAY
        fillContainer.addChild(textureBackground)
        fillContainer.addChild(textureForeground)
        app.stage.addChild(fillContainer)
        
        
    </script>
</body>

</html>